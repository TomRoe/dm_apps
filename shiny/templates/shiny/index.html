{% extends 'base.html' %}

{% load static %}
{% load i18n %}
{% load verbose_names %}

{% block body %}

    <div class="container-fluid">
        <div class="mb-5 row">
            <div class="col-2">
                <img src="{% static 'shiny/img/rproj.jfif' %}" alt="" width="100px">
            </div>
            <div class="">
                <h1>{% trans "Shiny Apps Hosted on DM Apps" %}</h1>
            </div>
        </div>


        {% if object_list.count %}

            <div class="row">
                <div class="col">
                    {% trans "(click on a header to sort table)" %}
                </div>
                <div class="col" style="text-align: center">
                    <em>{% trans 'displaying' %} {% trans "all" %} {{ object_list.count }} {% trans "records" %}</em>
                </div>
                <div class="col" style="text-align: right; padding-bottom: 10px">
                    <a href="{% url 'shiny:create' %}" class="btn btn-sm btn-success">{% trans 'New' %}</a>
                </div>
            </div>
            <table class="table table-stripped sortable">
                <thead>
                {% for field in field_list %}
                    <th>
                        {% get_verbose_label object_list.first field %}
                    </th>
                {% endfor %}
                </thead>
                <tbody>
                {% for object in object_list %}
                    <tr>
                        {% for field in field_list %}
                            <td>
                                {% if "thumbnail" in field %}
                                    {% if object.thumbnail %}
                                        <img src="{{ object.thumbnail.url }}" alt="" width="200px">
                                    {% else %}
                                        n/a
                                    {% endif %}

                                {% else %}
                                    {% get_field_value object field %}
                                {% endif %}
                            </td>
                        {% endfor %}
                        <td style="width: 200px">
                            <a href="{{ object.url|safe }}" class="btn btn-sm btn-primary" target="_blank">{% trans "Open App" %}</a>
                            {% if user == object.owner or user.is_superuser %}
                                <a href="{% url 'shiny:update' object.id %}" class="btn btn-sm btn-warning">{% trans "Edit record" %}</a>
                            {% endif %}

                        </td>
                    </tr>
                {% endfor %}

                </tbody>
            </table>

        {% else %}
            <em>No apps to display</em>
            <br>
            <br>
            <a href="{% url 'shiny:create' %}" class="btn btn-sm btn-success">{% trans 'Add the first app' %}</a>

        {% endif %}
    </div>

{% endblock %}