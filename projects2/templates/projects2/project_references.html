{% extends "projects2/base.html" %}
{% load static %}
{% load bootstrap4 %}
{% load verbose_names %}
{% load custom_filters %}
{% load i18n %}
{% load project_tags %}


{% block title_area %}
{% endblock %}

{% block header %}
  {{ block.super }}

{% endblock %}

{% block subcontent %}
  <div id="app">
    <div class="mb-3 row jumbotron px-1 py-3 row" style="width: 40%">
      <label for="search" class="col-4 col-form-label">{% trans "Find a Reference" %}</label>
      <div class="col">
        <input v-model="searchTerm" type="text" class="form-control" id="search" @keyup="submitSearch">
      </div>
    </div>
    <div class="row">
      <div class="col">
        <p class="h3 lead text-muted">{% trans "Current References:" %}</p>
        <div v-if="!project_citations_loading">
          <div v-for="(citation, index) in project_citations">
            <div class="alert alert-success" role="alert">
              <p v-html="citation.short_citation_html"></p>
              <button @click="removeCitation(citation)"><span class="mdi mdi-minus"></span> {% trans "Remove Reference" %}</button>
            </div>
          </div>
          <p v-if="!project_citations.length"><em>{% trans "This project does not currently have any references" %}</em></p>

        </div>
        <div v-else class="loading mb-3 mt-3 text-center mt-5">
          <div class="spinner-border mb-3" style="width: 10rem; height: 10rem;" role="status">
            <span class="sr-only"></span>
          </div>
        </div>
      </div>
      <div class="col">
        <p class="h3 lead text-muted">{% trans "Search Results:" %}</p>
        <div v-if="!citations_loading">
          <div v-for="(citation, index) in citations">
            <div class="alert alert-secondary" role="alert">
              <p v-html="citation.short_citation_html">

              </p>
              <button @click="addCitation(citation)"><span class="mdi mdi-plus"></span> {% trans "Add Reference" %}</button>
            </div>
          </div>
          <div v-if="!citations.length">
            <span v-if="hasSearched"><em>{% trans "No results found..." %}</em></span>
            <span v-else><em>{% trans "Please use the search bar to find references" %}</em></span>
          </div>

        </div>
        <div v-else class="loading mb-3 mt-3 text-center mt-5">
          <div class="spinner-border mb-3" style="width: 10rem; height: 10rem;" role="status">
            <span class="sr-only"></span>
          </div>
        </div>
      </div>
    </div>


  </div>

{% endblock %}


{% block body_js %}
  {{ block.super }}
  <script type="application/javascript">
  let projectId = {{ object.id }};
  </script>
  <script src="{% static '/projects2/mainProjectReferences.js' %}?version=1.2" type="application/javascript"></script>


{% endblock %}