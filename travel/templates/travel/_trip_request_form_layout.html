{% load i18n %}
{% load static %}
{% load verbose_names %}
{% load custom_filters %}
{% load custom_tags %}
{% load bootstrap4 %}

{# If the field has a special class, make sure the wrapping div element inherit this class name too #}

{% if "not-a-group-field" in field.field.widget.attrs.class %}
  {% echo "not-a-group-field" as group_class %}
{% endif %}

{% if "disappear-if-user" in field.field.widget.attrs.class %}
  {% echo "disappear-if-user" as user_class %}
{% endif %}

{% if "hide-if-not-public-servant" in field.field.widget.attrs.class %}
  {% echo "hide-if-not-public-servant" as hide_if_not_public_servant_class %}
{% endif %}

{% if "hide-if-public-servant" in field.field.widget.attrs.class %}
  {% echo "hide-if-public-servant" as hide_if_public_servant_class %}
{% endif %}

{% if field.name == "is_group_request" %}
  {% echo "group_request_container" as group_request_container_id %}
{% endif %}



<div class="{{ group_class }} {{ user_class }} {{ hide_if_not_public_servant_class }} {{ hide_if_public_servant_class }}"
     id="{{ group_request_container_id }}">
  {% if field.name != "late_justification" %}

    {% bootstrap_label field.label %}

    {% if field.name in help_text_dict %}
      &nbsp;
      {% with help_text_dict|lookup:field.name as help_text %}
        <img src="{% static 'img/icons/information.png' %}" style="width: 20px" data-toggle="popover"
             data-trigger="hover"
             title="{{ field.label }}"
             data-content="{{ help_text }}">
      {% endwith %}
    {% endif %}

    {% bootstrap_field field placeholder="" show_label=False %}

    {% if field.name == "trip" %}
      <div class="mb-3">
        <a id="add_trip" class="btn btn-sm btn-success py-0 px-1" tabindex="-1" href="#" pop-href="{% url 'travel:trip_new' "pop" %}">
          {% trans "add a new trip" %}
        </a>
      </div>
      <div id="late_justification_div">
        <div class="alert alert-danger" role="alert">
          <h4 class="alert-heading">
            {% trans "The submission deadline for this trip has already passed. " %}
          </h4>
          <p>
            {% blocktrans %}
              Understanding that not all potential trips can be predicted, unforeseen requests can be submitted via the Conference and
              Travel Management System for consideration.
              <br><br>
              These requests must have a very strong rationale outlining the necessity of the trip and clearly articulate the reason for the
              late request; requests of this nature will only be approved in exceptional circumstances.
            {% endblocktrans %}
          </p>

        </div>
        <label class="h5 red-font" for="id_late_jsutification">{% trans "Please provide your late justification here" %}</label>
        {% bootstrap_field form.late_justification placeholder="" show_label=False %}
      </div>

    {% endif %}

    {% if field.name == "is_group_request" %}
      <div class="show-me-when-group-request blue-font mb-3">
        <p>
          <em>
            {% trans "(Once this form is submitted, you will be able to add group travellers to the request. You will be automatically added as a traveller.)" %}
          </em>
        </p>
      </div>
    {% endif %}

    {% if field.name == "address" %}
      <div class="mb-4">
            <span style="font-size: small">
                {% trans "Use a Predefined Address:" %}
            </span> &nbsp;
        {{ org_form.orgs }}
      </div>
    {% endif %}
  {% endif %}


</div>
