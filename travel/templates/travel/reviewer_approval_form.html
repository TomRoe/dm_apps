{% extends "travel/form.html" %}
{% load static %}
{% load bootstrap4 %}
{% load verbose_names %}
{% load custom_filters %}
{% load i18n %}
{% block header %}
  {{ block.super }}
  <style>
  .label {
      font-weight: bold;
  }

  table, td {
      font-size: small;
  }
  </style>

{% endblock %}

{% block area_above_h1 %}
  <span id="the-top"></span>
{% endblock %}

{% block pre_form_div %}
  {% bootstrap_form_errors form %}

  <hr>
  <div id="app">
    {% include "travel/_trip_request_detail.html" %}
  </div>

  <div class="float-right mb-3">
    <a class="btn btn-outline-dark " href="{% url 'travel:request_print' triprequest.id %}" target="_blank">
      {% trans "Print Travel Request and Approval Form (TRAF)" %}&nbsp; <img src="{% static 'img/icons/pdf.svg' %}" alt="" width="20px">
    </a>
    <a class="btn btn-outline-dark" href="{% url 'travel:export_cfts_request' triprequest.id %}" target="_blank">
      {% trans "CFTS Report" %} &nbsp; <img src="{% static 'img/icons/excel.svg' %}" alt="" width="20px">
    </a>
  </div>
  <br>
  <br>
{% endblock %}


{% block form_fields %}
  <div class="mt-5">
    {% for field in form %}
      {% if field.name == 'comments' %}
        <h3>{% trans "Please provide your approval comments here (required)" %}</h3>
        {% bootstrap_field field show_label=False %}

      {% else %}
        {{ field }}
      {% endif %}

    {% endfor %}


  </div>
{% endblock %}

{% block form_buttons %}

  <div class="mb-5">
    <a class="btn btn-secondary" id="save" href="#id_comments">
      {% trans "Save comments" %}
    </a>
    <a class="btn btn-success" id="yes" href="#id_comments">
      {% trans "I approve" %}
    </a>
    <a class="btn btn-danger" id="no" href="#id_comments">
      {% trans "I do not approve" %}
    </a>
    <a class="btn" id="request_changes" href="#id_comments" style="background-color: orange">
      {% trans "Request changes" %}
    </a>
    <a class="btn btn-primary" href="{% url 'travel:request_detail' triprequest.id "all" %}" target="_blank">
      {% trans "Make changes yourself" %} <span class="mdi mdi-arrow-top-right text-light"></span>
    </a>

    <input type="submit" class="hidden">
  </div>
{% endblock %}


{% block post_form_div %}



{% endblock %}

<br><br><br>



{% block body_js %}
  <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>

  <script type="application/javascript">
  var trip_request_id = {{ triprequest.id }};
  </script>
  <script src="{% static 'travel/mainTripRequest.js' %}"></script>

  <script type="application/javascript">
  $("#yes").click(function () {
    $("#id_approved").val(true);
    $("form").submit();
  });
  $("#no").click(function () {
    $("#id_approved").val(false);
    $("form").submit();
  });
  $("#save").click(function () {
    $("#id_stay_on_page").val(1);
    $("form").submit();
  });
  $("#request_changes").click(function () {
    $("#id_changes_requested").val(true);
    $("form").submit();
  });

  </script>

  {#    // have to reload some other JS scripts... due to import of vue js#}
  <script type="text/javascript" src="{% static "js/clickableTableRows.js" %}?version=1.1.7"></script>
  <script type=" text/javascript" src="{% static "js/popItOut.js" %}?version=1.2.2"></script>

{% endblock %}

