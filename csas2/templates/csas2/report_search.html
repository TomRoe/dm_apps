{% extends "csas2/base.html" %}
{% load static %}
{% load bootstrap4 %}
{% load i18n %}
{% block content %}

  <br>
  {# <img src="{% static 'glf_data_management/img/data.jpg' %}" class="img-fluid max-width" alt="file not found"> #}
  <div class="container">
    <div class="jumbotron">
      <h2>
        {% trans "Please select a report" %}
      </h2>
      <hr>
      <form method="post" style="width: auto">

        {% csrf_token %}
        {% for field in form %}
          <div class="{{ field.name }}_div">
            {% bootstrap_field field layout="horizontal" %}
          </div>
        {% endfor %}

        <div class="mt-3">
          <input id="submit" type="submit" class="btn btn-primary animated bounceOutLeft" value="Generate"><br><br>
        </div>


      </form>

      <div class="loader hidden"></div>
    </div>
  </div>

  <script src="{% static 'lou-multi-select-e052211/js/jquery.multi-select.js' %}" type="text/javascript"></script>
  <script type="application/javascript">

  function hideAll() {
    $(".fiscal_year_div").addClass("gone");
    $(".is_posted_div").addClass("gone");
    $(".request_status_div").addClass("gone");
    $(".region_div").addClass("gone");
    $(".sector_div").addClass("gone");
    $(".division_div").addClass("gone");
    $(".section_div").addClass("gone");
    $(".csas_requests_div").addClass("gone");

    $("#id_fiscal_year").prop("required", false);
    $("#id_is_posted").prop("required", false);
    $("#id_request_status").prop("required", false);
    $("#id_region").prop("required", false);
    $("#id_sector").prop("required", false);
    $("#id_division").prop("required", false);
    $("#id_section").prop("required", false);
    $("#id_csas_requests").prop("required", false);

  }

  function configureForm() {
    var reportChoice = $("#id_report")[0].value;
    // cfts report
    if (reportChoice === "1") {
      $(".fiscal_year_div").removeClass("gone");
      $("#id_fiscal_year").prop("required", false);
      $(".is_posted_div").removeClass("gone");
      $("#id_is_posted").prop("required", false);
    } else if (reportChoice === "2") {
      $(".fiscal_year_div").removeClass("gone");
      $(".request_status_div").removeClass("gone");
      $(".region_div").removeClass("gone");
      $(".sector_div").removeClass("gone");
      $(".division_div").removeClass("gone");
      $(".section_div").removeClass("gone");
      $(".csas_requests_div").removeClass("gone");
    }
  }

  $(document).ready(function () {
    // Stuff to do as soon as the DOM is ready
    hideAll();
    configureForm();
  });


  $("#id_report").change(function () {
    hideAll();
    configureForm();
  });

  $("form").submit(function () {
    var reportChoice = $("#id_report")[0].value;
    // species count report

    if (reportChoice != 4) {
      $(this).addClass("hidden");
      $(".loader").removeClass("hidden");
      window.setTimeout(closeLoader, 5000)
    }
  });

  function closeLoader() {
    $("form").removeClass("hidden");
    $(".loader").addClass("hidden");
  }


  </script>

{% endblock content %}
