{% load static %}
{% load humanize %}
{% load i18n %}

<style>
    table, td {
        font-size: small;
    }
</style>

<h3>
    {% trans "Project Staff:" %}
</h3>
<a class="btn btn-sm btn-primary" href="#"
   onclick="return popitup('{% url 'projects:staff_new' object.id %}','popoutWindow')">
    {% trans "Add Staff" %}
</a><br><br>

{% if object.staff_members.count == 0 %}
    <em>
        {% trans "No Staff Members" %}
    </em><br>
{% else %}

    <table class="table table-hover table-sm">
        <tr>
            <th></th>
            <th>
                {% trans "Name" %}
            </th>
            <th>
                {% trans "Employee type" %}
            </th>
            <th>
                {% trans "Level" %}
            </th>
            <th>
                {% trans "Duration (weeks)" %}
            </th>
            <th>
                {% trans "Overtime hours" %}
            </th>
            <th>
                {% trans "Cost Category" %}
            </th>
            <th>
                {% trans "Cost" %}
            </th>
        </tr>
        <tbody>
        {% for obj in object.staff_members.all %}
            <tr href="{% url 'projects:staff_edit' obj.id %}" pop data-toggle="tooltip" title="Edit">
                <td>
                    <a class="staff-delete-me" href="#" val="{{ obj.id }}">
                        <img src="{% static "/admin/img/icon-deletelink.svg" %}" data-toggle="tooltip"
                             title="Delete">
                    </a>
                    <a id="staff-secrect-delete-btn-{{ obj.id }}"
                       href="{% url 'projects:staff_delete' obj.id %}" class="hidden"></a>
                </td>
                <td>
                    {% if obj.user.id %}
                        {{ obj.user.first_name }} {{ obj.user.last_name }}
                    {% else %}
                        {{ obj.name }}
                    {% endif %}
                </td>

                {% if obj.employee_type %}
                    <td>
                        {% else %}
                    <td class="bad">
                {% endif %}
                {{ obj.employee_type }}
                {% if  obj.employee_type is 4 %}
                    ({{ obj.student_program }}
                {% endif %}
                </td>

                <td>
                    {{ obj.level }}
                </td>


                {% if obj.duration_weeks %}
                    <td>
                        {% else %}
                    <td class="bad">
                {% endif %}
                {{ obj.duration_weeks }}
                </td>


                <td>
                    {{ obj.overtime_hours }}
                </td>

                <td>{{ obj.employee_type.get_cost_type_display }}</td>

                <td>
                    {{ obj.cost|floatformat:0|intcomma }}
                </td>


            </tr>
        {% endfor %}
        {#    <tr style="font-weight: bold;">#}
        {#        <td>Count: <span style="margin-left: 15px">{{ object.staff_members.count }}</span></td>#}
        {#    </tr>#}
        </tbody>
    </table>
{% endif %}
<br>