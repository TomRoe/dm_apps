{% load static %}
{% load nz %}
{% load humanize %}
{% load i18n %}
{% get_current_language as LANG %}

<style>
    table, td {
        font-size: small;
    }
</style>

<h3>
    {% trans "O&M Requests:" %}
</h3>
<div class="btn-group">
    <a class="btn btn-sm btn-primary" href="#"
       onclick="return popitup('{% url 'projects:om_new' object.id %}','popoutWindow')">
        {% trans "Add O&M" %}
    </a>
    <a class="btn btn-sm btn-success" href="{% url 'projects:om_populate' object.id %}">
        {% trans "Add all categories" %}
    </a>

    <a class="btn btn-sm btn-warning" href="{% url 'projects:om_clear' object.id %}">
        {% trans "Clear empty lines" %}
    </a>
</div>

<br><br>


{% if object.om_costs.count == 0 %}
    <em>
        {% trans "No O&M Requests" %}
    </em><br>
{% else %}

    <table class="table table-hover table-sm">
        <tr>
            <th></th>
            <th>
                {% trans "Category Type" %}
            </th>
            <th>
                {% trans "Category" %}
            </th>
            <th>
                {% trans "Budget Requested" %}
            </th>
            <th>
                {% trans "Description provided" %}
            </th>

        </tr>
        <tbody>
        {% for obj in object.om_costs.all %}
            <tr data-toggle="tooltip" title="Edit" href="{% url 'projects:om_edit' obj.id %}" pop>
                <td>
                    <a class="om-delete-me" href="#" val="{{ obj.id }}">
                        <img src="{% static "/admin/img/icon-deletelink.svg" %}" data-toggle="tooltip"
                             title="Delete">
                    </a>
                    <a id="om-secrect-delete-btn-{{ obj.id }}"
                       href="{% url 'projects:om_delete' obj.id %}" class="hidden"></a>
                </td>
                <td>{{ obj.om_category.get_group_display }}</td>

                {% if LANG == "fr" %}
                    <td>{{ obj.om_category.nom }}</td>
                {% else %}
                    <td>{{ obj.om_category.name }}</td>
                {% endif %}

                <td>{{ obj.budget_requested|floatformat:0|intcomma }}</td>
                <td>{{ obj.description|yesno:"yes,," }}</td>


            </tr>
        {% endfor %}
        {#    <tr style="font-weight: bold;">#}
        {#        <td>Count: <span style="margin-left: 15px">{{ object.agreements.count }}</span></td>#}
        {#    </tr>#}
        </tbody>
    </table>
{% endif %}
<br>
