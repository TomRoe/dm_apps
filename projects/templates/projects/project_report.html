{% load verbose_field_display %}
{% load bootstrap4 %}
{% load humanize %}
{% load nz %}
{% load i18n %}

{% bootstrap_css %}

<style>
    .label {
        font-weight: bold;
    }

    table, td, th {
        font-size: small;
        border: 1px solid black;
        text-align: left;
        border-collapse: collapse;
    }

    td, th {
        padding-top: 1px;
    }
    th {
        background-color: lightgray;
        color: black;
    }
</style>


<hr>
<h3>
    {% trans "Project Detail:" %}
</h3>

{% for field in field_list %}
    {% verbose_field_display object field %}
{% endfor %}

{# STAFF #}
<h3>
    {% trans "Project Staff:" %}
</h3>

{% if object.staff_members.count == 0 %}
    <br><em>No Staff Members</em><br>
{% else %}
    <table>
        <tr>
            <th>
                {% trans "Name" %}
            </th>
            <th>
                {% trans "Employee type" %}
            </th>
            <th>
                {% trans "Level" %}
            </th>
            <th>
                {% trans "Duration (weeks)" %}
            </th>
            <th>
                {% trans "Overtime hours" %}
            </th>
            <th>
                {% trans "Cost Category" %}
            </th>
            <th>
                {% trans "Cost" %}
            </th>
        </tr>
        <tbody>
        {% for obj in object.staff_members.all %}
            <tr>

                <td>
                    {% if obj.user.id %}
                        {{ obj.user.first_name }} {{ obj.user.last_name }}
                    {% else %}
                        {{ obj.name }}
                    {% endif %}
                </td>

                <td>
                    {{ obj.employee_type }}
                    {% if  obj.employee_type is 4 %}
                        ({{ obj.student_program }}
                    {% endif %}
                </td>

                <td>
                    {{ obj.level }}
                </td>


                <td>
                    {{ obj.duration_weeks }}
                </td>


                <td>
                    {{ obj.overtime_hours }}
                </td>

                <td>{{ obj.employee_type.get_cost_type_display }}</td>

                <td>
                    {{ obj.cost|floatformat:2|intcomma }}
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% endif %}
<br>

{# Collaborators #}
<h3>
    {% trans "Collaborators & Partners:" %}
</h3>
{% if object.collaborators.count == 0 %}
    <em>
        {% trans "No Collaborators or Partners" %}
    </em><br>
{% else %}

    <table>
        <tr>
            <th>
                {% trans "Name" %}
            </th>
            <th>
                {% trans "Type" %}
            </th>
            <th>
                {% trans "Critical to project?" %}
            </th>
            <th>
                {% trans "Notes" %}
            </th>


        </tr>
        <tbody>
        {% for obj in object.collaborators.all %}
            <tr>
                <td>{{ obj.name }}</td>
                <td>{{ obj.get_type_display }}</td>
                <td>{{ obj.critical|yesno }}</td>
                <td>{{ obj.notes }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% endif %}
<br>


{# Agreements #}
<h3>
    {% trans "Collaborative Agreements:" %}
</h3>

{% if object.agreements.count == 0 %}
    <em>
        {% trans "No Collaborative Agreements" %}
    </em><br>
{% else %}

    <table>
        <tr>
            <th>
                {% trans "Partner Organization" %}
            </th>
            <th>
                {% trans "Project Lead" %}
            </th>
            <th>
                {% trans "Agreement Title" %}
            </th>
            <th>
                {% trans "New or Existing" %}
            </th>
            <th>
                {% trans "Notes" %}
            </th>
        </tr>
        <tbody>
        {% for obj in object.agreements.all %}
            <tr>
                <td>{{ obj.partner_organization }}</td>
                <td>{{ obj.project_lead }}</td>
                <td>{{ obj.agreement_title }}</td>
                <td>{{ obj.new_or_existing }}</td>
                <td>{{ obj.notes }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% endif %}
<br>

{# OM COSTS #}
<h3>
    {% trans "O&M Requests:" %}
</h3>

{% if object.om_costs.count == 0 %}
    <em>
        {% trans "No O&M Requests" %}
    </em><br>
{% else %}

    <table>
        <tr>
            <th>
                {% trans "Category Type" %}
            </th>
            <th>
                {% trans "Category" %}
            </th>
            <th>
                {% trans "Description" %}
            </th>
            <th>
                {% trans "Budget Requested" %}
            </th>
        </tr>
        <tbody>
        {% for obj in object.om_costs.all %}
            <tr>
                <td>{{ obj.om_category.get_group_display }}</td>
                <td>{{ obj.om_category.name }}</td>
                <td>{{ obj.description }}</td>
                <td>${{ obj.budget_requested|floatformat:2 }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% endif %}
<br>


{# Capital COSTS #}
<h3>
    {% trans "Capital Requests:" %}
</h3>

{% if object.capital_costs.count == 0 %}
    <em>
        {% trans "No Capital Requests" %}
    </em><br>
{% else %}

    <table>
        <tr>
            <th>
                {% trans "Category" %}
            </th>
            <th>
                {% trans "Description" %}
            </th>
            <th>
                {% trans "Budget Requested" %}
            </th>
        </tr>
        <tbody>
        {% for obj in object.capital_costs.all %}
            <tr>
                <td>{{ obj.get_category_display }}</td>
                <td>{{ obj.description|nz:"" }}</td>
                <td>${{ obj.budget_requested|floatformat:2|intcomma }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% endif %}
<br>

{# GC COSTS#}
<h3>
    {% trans "G&C Requests:" %}
</h3>

{% if object.gc_costs.count == 0 %}
    <em>
        {% trans "No G&C Requests" %}
    </em><br>
{% else %}

    <table class="table table-bordered table-sm">
        <tr>
            <th>
                {% trans "Recipient Organization" %}
            </th>
            <th>
                {% trans "Project Lead" %}
            </th>
            <th>
                {% trans "Proposed Title" %}
            </th>
            <th>
                {% trans "G&C Program" %}
            </th>
            <th>
                {% trans "Budget Requested" %}
            </th>
        </tr>
        <tbody>
        {% for obj in object.gc_costs.all %}
            <tr>
                <td>{{ obj.recipient_org }}</td>
                <td>{{ obj.project_lead }}</td>
                <td>{{ obj.proposed_title }}</td>
                <td>{{ obj.gc_program }}</td>
                <td>${{ obj.budget_requested|floatformat:2|intcomma }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% endif %}
<br>

{# FINANCIAL SUMMARY #}

{% load static %}
{% load humanize %}
<style>
    table, td {
        font-size: small;
    }
</style>

<div class="">
    <h3>
        {% trans "Financial Summary:" %}
    </h3>
</div>

<table>
    <tr>
        <th>
            {% trans "Category" %}
        </th>
        <th>
            {% trans "Total Cost" %}
        </th>
    </tr>
    <tbody>
    <tr>
        <td>
            {% trans "Salary (excluding full time employees)" %}
        </td>
        <td>${{ salary_total|floatformat:2|intcomma }}</td>
    </tr>
    <tr>
        <td>
            {% trans "O & M" %}
        </td>
        <td>${{ om_total|floatformat:2|intcomma }}</td>
    </tr>
    <tr>
        <td>
            {% trans "Capital" %}
        </td>
        <td>${{ capital_total|floatformat:2|intcomma }}</td>
    </tr>
    <tr>
        <td>
            {% trans "G & C" %}
        </td>
        <td>${{ gc_total|floatformat:2|intcomma }}</td>
    </tr>


    </tbody>
</table>
{#{% include "projects/_financial.html" %}#}
