{% load verbose_names %}
{% load bootstrap4 %}
{% load humanize %}
{% load custom_filters %}
{% load i18n %}
{% load custom_tags %}
{% load custom_filters %}
{% bootstrap_css %}

<style>
    .label {
        font-weight: bold;
    }

    table, td {
        vertical-align: top;
    }

    table.et, td.et, th.et {
        font-size: small;
        border: 1px solid black;
        text-align: left;
        border-collapse: collapse;
    }

    td.et, th.et {
        padding-top: 1px;
    }

    th.et {
        background-color: lightgray;
        color: black;
    }
</style>

<h1 style="font-size: 25px; font-weight: bold">{{ org }}</h1>
<hr>
<h2>
    {% trans "Organization Information" %}
</h2>
<table>
    <td>
        {% for field in org_field_list_1 %}
            {% verbose_field_display org field %}
        {% endfor %}
        <br>
    </td>
    <td>
        {% for field in org_field_list_2 %}
            {% verbose_field_display org field %}
        {% endfor %}
        <br>
    </td>
    <td>
        {% for field in org_field_list_3 %}
            {% verbose_field_display org field %}
        {% endfor %}
        <br>
    </td>
    <td>
        {% for field in org_field_list_4 %}
            {% verbose_field_display org field %}
        {% endfor %}
        <br>
    </td>
</table>
<hr>

<h2>
    {% trans "List of Contacts" %}
</h2>


<table>
    {% for row in contact_table_rows %}
        <tr>
            {% for cell in one_to_four %}
                {% with row|multiply:4|add:cell as pos %}
                    {% get_subset org.members.all pos as member %}
                    <td>
                        <p>
                            <b>{{ member.person }}</b><br>
                            <em>
                                {% for role in member.roles.all %}
                                    {% if role.id == 3 %}
                                        <span style="background-color: yellow">{{ role }},</span>
                                    {% else %}
                                        {{ role }},
                                    {% endif %}
                                {% endfor %}
                            </em>
                            {{ member.person.contact_card_no_name|safe }}<br><br>
                        </p>
                    </td>
                {% endwith %}
            {% endfor %}
        </tr>
    {% endfor %}
</table>

<hr>

<h2>
    {% trans "iHub Entries" %}
</h2>

{% if not org.entries.count %}
    <em>
        {% trans "There are no entries to display for this organization" %}
    </em>

{% else %}
    {% for entry in org.entries.all %}
        <span style="font-size: 18px; font-style: italic">{{ entry.title }}</span>
        <table>
            <td>
                {% for field in entry_field_list_1 %}
                    {% verbose_field_display entry field %}
                {% endfor %}
                <br>
            </td>
            <td>
                {% for field in entry_field_list_2 %}
                    {% verbose_field_display entry field %}
                {% endfor %}
                <br>
            </td>
            <td>
                {% for field in entry_field_list_3 %}
                    {% verbose_field_display entry field format="currency" %}
                {% endfor %}
                <br>
            </td>
            <td>
                {% for field in entry_field_list_4 %}
                    {% verbose_field_display entry field format="currency" %}
                {% endfor %}
                <br>
            </td>
            <td>
                <p><b>Amount outstanding:</b><br>${{ entry.amount_outstanding|floatformat:2|intcomma }}</p>
                {% for field in entry_field_list_5 %}
                    {% verbose_field_display entry field %}
                {% endfor %}
                <br>
            </td>
        </table>
    {% endfor %}

{% endif %}

<p>
    <em style="font-size: 10px">This report was generated by iHub on {{ now }}</em>
</p>
